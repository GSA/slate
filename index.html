<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>i14y API Instructions</title>

    <link href="stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
      <script src="javascripts/all.js" type="text/javascript"></script>

      <script>
        $(function() {
          setupLanguages(["sh"]);
        });
      </script>
  </head>

  <body class="index">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo.png" />
        <div class="lang-selector">
              <a href="#" data-language-name="sh">cURL</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='mailto:search@support.digitalgov.gov'>Email us for an i14y API key</a></li>
            <li><a href='http://github.com/GSA/slate'>Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="what-is-i14y?">What is i14y?</h1>

<p>Our i14y API allows you to send content directly from your content management system (CMS) into <a href="http://search.digitalgov.gov/">DigitalGov Search</a> for real-time indexing. By hooking into your CMS workflow, you can immediately <a href="#create-a-document">create</a>, <a href="#update-a-document">update</a>, and <a href="#delete-a-document">delete</a> the associated documents in our search indexes via this API.</p>

<p>Even if you donâ€™t have a CMS, you can develop software to publish your content in a way that meets the i14y API specifications below.</p>

<p>Ruby/Python/Node clients are welcome.</p>

<p>Using i14y is optional. The rest of our service offering will continue as-is, providing the default web results from commercial indexes.</p>

<h2 id="what-are-the-main-benefits-of-i14y?">What are the main benefits of i14y?</h2>

<p>By a long shot, the two features we get asked for most are:</p>

<ol>
<li>Immediate inclusion of new or updated content in search results.</li>
<li>Control over which documents are (or are not) in your search index.</li>
</ol>

<p>i14y answers both of these requests.</p>

<h1 id="authentication">Authentication</h1>

<p>You&rsquo;ll need to have a <a href="https://search.usa.gov/sites">DigitalGov Search account</a> and at least one site already set up.</p>

<blockquote>
<p>To authorize, use this code:</p>
</blockquote>
<pre class="highlight shell"><code><span class="c"># With curl, you can just pass the correct header with each request</span>
curl <span class="s2">"https://i14y.usa.gov/api/v1/documents"</span>
  -XPOST 
  -H <span class="s2">"Content-Type:application/json"</span>
  -u your_drawer_handle:your_secret_token 
</code></pre>

<blockquote>
<p>Replace <code class="prettyprint">your_drawer_handle</code> with your drawer handle, and replace <code class="prettyprint">your_secret_token</code> with your API key.</p>
</blockquote>

<p>The i14y API uses keys to allow access to the API. While we&rsquo;re still in beta, <a href="mailto:search@support.digitalgov.gov">email us</a> to request access.</p>

<p>The i14y API expects the key to be included in all API requests to the server in a Basic authentication header that looks like the following:</p>

<p><code class="prettyprint">Authorization: Basic qG9yZW46bG9yZW5pMTR5dG9rZW4=</code></p>

<aside class="notice">
Replace <code>your_drawer_handle</code> with your drawer handle, and replace <code>your_secret_token</code> with your API key.
</aside>

<h1 id="create,-update,-and-delete-documents">Create, update, and delete documents</h1>

<h2 id="create-a-document">Create a document</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://i14y.usa.gov/api/v1/documents"</span>
  -XPOST 
  -H <span class="s2">"Content-Type:application/json"</span>
  -u your_drawer_handle:your_secret_token
  -d <span class="s1">'{"document_id":"1",
      "title":"this is a fairly short title",
      "path": "http://www.gov.gov/cms/doc1.html", 
      "created": "2015-05-12T22:35:09Z",
      "description":"some more information here on the document", 
      "content":"the long form body of the document", 
      "promote": false, 
      "language" : "en",
      "tags" : "tag1, another tag"
      }'</span>
</code></pre>

<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
</span><span class="s2">"status"</span><span class="p">:</span><span class="mi">200</span><span class="p">,</span><span class="w">
</span><span class="s2">"developer_message"</span><span class="p">:</span><span class="s2">"OK"</span><span class="p">,</span><span class="w">
</span><span class="s2">"user_message"</span><span class="p">:</span><span class="s2">"Your document was successfully created."</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This endpoint creates a document.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">POST https://i14y.usa.gov/api/v1/documents</code></p>

<p>You must use https.</p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>document_id</td>
<td>true</td>
<td>A document ID that is unique to your CMS. It cannot begin with a forward slash.</td>
</tr>
<tr>
<td>title</td>
<td>true</td>
<td>Document title</td>
</tr>
<tr>
<td>path</td>
<td>true</td>
<td>Document link URL</td>
</tr>
<tr>
<td>created</td>
<td>true</td>
<td>When the document was initially created (such as &lsquo;2013-02-27T10:00:00Z&rsquo;)</td>
</tr>
<tr>
<td>description</td>
<td>false*</td>
<td>Document description</td>
</tr>
<tr>
<td>content</td>
<td>false*</td>
<td>Document content</td>
</tr>
<tr>
<td>changed</td>
<td>false</td>
<td>When document was modified (such as &#39;2013-02-27T10:00:01Z&rsquo;)</td>
</tr>
<tr>
<td>promote</td>
<td>false</td>
<td>Whether to promote the document in the relevance ranking</td>
</tr>
<tr>
<td>language</td>
<td>false</td>
<td>Two-letter <a href="https://github.com/GSA/punchcard/tree/master/localizations">locale</a> describing language of document (defaults to &#39;en&rsquo;)</td>
</tr>
<tr>
<td>tags</td>
<td>false</td>
<td>Comma-separated list of case-insentitive tags</td>
</tr>
</tbody></table>

<aside class="success">
* You must pass either a description or content, and preferably both!
</aside>

<aside class="notice">
Attempting to create a document with a `document_id` that already exists results in an error.
</aside>

<h2 id="update-a-document">Update a document</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://i14y.usa.gov/api/v1/documents/{uri_encoded_document_id}"</span>
  -XPUT 
  -H <span class="s2">"Content-Type:application/json"</span>
  -u your_drawer_handle:your_secret_token
  -d <span class="s1">'{"title":"check out this info...today only!",
      "promote": true"
      }'</span>
</code></pre>

<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
</span><span class="s2">"status"</span><span class="p">:</span><span class="mi">200</span><span class="p">,</span><span class="w">
</span><span class="s2">"developer_message"</span><span class="p">:</span><span class="s2">"OK"</span><span class="p">,</span><span class="w">
</span><span class="s2">"user_message"</span><span class="p">:</span><span class="s2">"Your document was successfully updated."</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This endpoint updates a document.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">PUT https://i14y.usa.gov/api/v1/documents/{uri_encoded_document_id}</code></p>

<p>You must use https.</p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>title</td>
<td>false</td>
<td>Document title</td>
</tr>
<tr>
<td>path</td>
<td>false</td>
<td>Document link URL</td>
</tr>
<tr>
<td>created</td>
<td>false</td>
<td>When document was initially created (such as &#39;2013-02-27T10:00:00Z&rsquo;)</td>
</tr>
<tr>
<td>description</td>
<td>false</td>
<td>Document description</td>
</tr>
<tr>
<td>content</td>
<td>false</td>
<td>Document content</td>
</tr>
<tr>
<td>changed</td>
<td>false</td>
<td>When document was modified (such as &#39;2013-02-27T10:00:01Z&rsquo;)</td>
</tr>
<tr>
<td>promote</td>
<td>false</td>
<td>Whether to promote the document in the relevance ranking</td>
</tr>
<tr>
<td>language</td>
<td>false</td>
<td>Two-letter <a href="https://github.com/GSA/punchcard/tree/master/localizations">locale</a> describing language of document (defaults to &#39;en&rsquo;)</td>
</tr>
<tr>
<td>tags</td>
<td>false</td>
<td>Comma-separated list of case-insentitive tags</td>
</tr>
</tbody></table>

<aside class="success">
Your updates are reflected in your search results within seconds!
</aside>

<aside class="notice">
The `uri_encoded_document_id` is the ID you assigned to the document when you created it. It must be URI encoded here.
</aside>

<h2 id="delete-a-document">Delete a document</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://i14y.usa.gov/api/v1/documents/{uri_encoded_document_id}"</span>
  -XDELETE 
  -u your_drawer_handle:your_secret_token
</code></pre>

<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
</span><span class="s2">"status"</span><span class="p">:</span><span class="mi">200</span><span class="p">,</span><span class="w">
</span><span class="s2">"developer_message"</span><span class="p">:</span><span class="s2">"OK"</span><span class="p">,</span><span class="w">
</span><span class="s2">"user_message"</span><span class="p">:</span><span class="s2">"Your document was successfully deleted."</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This endpoint deletes a document.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">DELETE https://i14y.usa.gov/api/v1/documents/{uri_encoded_document_id}</code></p>

<p>You must use https.</p>

<aside class="notice">
The `uri_encoded_document_id` is the ID you assigned to the document when you created it. It must be URI encoded here.
</aside>

          <h1 id="errors">Errors</h1>

<p>The i14y API uses the following error codes:</p>

<table><thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td>Bad Request &ndash; There is a problem with your request</td>
</tr>
<tr>
<td>500</td>
<td>Internal Server Error &ndash; There is a problem with our server and we&rsquo;ve been notified. Try again later.</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="sh">cURL</a>
          </div>
      </div>
    </div>
  </body>
</html>
